<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="//gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.54.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>日志 &middot; Daily note</title>

  
  <link type="text/css" rel="stylesheet" href="https://daily.whidy.netcss/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://daily.whidy.netcss/poole.css">
  <link type="text/css" rel="stylesheet" href="https://daily.whidy.netcss/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://daily.whidy.netcss/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Daily note" />

  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://daily.whidy.net"><h1>Daily note</h1></a>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://daily.whidy.net">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2019. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>日志</h1>
  <time datetime=2018-03-16T00:00:00Z class="post-date">Fri, Mar 16, 2018</time>
  

<blockquote>
<p>2018年3月16日 阴 一般</p>
</blockquote>

<h1 id="博客转移-域名解析-其他配置">博客转移/域名解析/其他配置</h1>

<p>域名解析, 全部设置为A记录指向服务器IP, 然后还是用原来的301转向, <code>(www.)whidy.cn</code>和<code>whidy.net</code>全部跳转到<code>www.whidy.net</code>.</p>

<h2 id="apache服务器优化">Apache服务器优化</h2>

<h3 id="rewrite模块">Rewrite模块</h3>

<p>为了<code>伪静态</code>页面和<code>301重定向</code>, 这边文章讲得很清楚了<a href="https://devops.profitbricks.com/tutorials/install-and-configure-mod_rewrite-for-apache-on-centos-7/">Install and Configure mod_rewrite for Apache on CentOS 7</a></p>

<h3 id="开启gzip压缩功能">开启Gzip压缩功能</h3>

<h4 id="方案一-修改httpd-conf配置">方案一: 修改httpd.conf配置</h4>

<p>如上文: 打开这个文件</p>

<pre><code class="language-bash"># nano /etc/httpd/conf.modules.d/00-base.conf
</code></pre>

<p>检查<code>mod_deflate module</code>是否正常开启(默认是开启的)</p>

<pre><code>LoadModule deflate_module modules/mod_deflate.so
</code></pre>

<p>然后修改<code>httpd.conf</code></p>

<pre><code class="language-bash"># nano /etc/httpd/conf/httpd.conf
</code></pre>

<p>文件末尾增加</p>

<pre><code>AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
</code></pre>

<p>重启服务</p>

<pre><code class="language-bash"># service httpd restart
</code></pre>

<h4 id="方案二-修改网站-htaccess文件">方案二: 修改网站.htaccess文件</h4>

<p>你也可以在Apache虚拟主机上通过配置<code>.htaccess</code>来开启<code>gzip compression</code>, 修改<code>.htaccess</code>增加以下代码:</p>

<pre><code class="language-xml">&lt;Directory /var/www/html/&gt;
   &lt;IfModule mod_mime.c&gt;
	AddType application/x-javascript .js
	AddType text/css .css
   &lt;/IfModule&gt;
   &lt;IfModule mod_deflate.c&gt;
	AddOutputFilterByType DEFLATE text/css application/x-javascript text/x-component text/html text/plain text/xml application/javascript
	&lt;IfModule mod_setenvif.c&gt;
		BrowserMatch ^Mozilla/4 gzip-only-text/html
		BrowserMatch ^Mozilla/4.0[678] no-gzip
		BrowserMatch bMSIE !no-gzip !gzip-only-text/html
	&lt;/IfModule&gt;
    &lt;/IfModule&gt;
    Header append Vary User-Agent env=!dont-vary
&lt;/Directory&gt;
</code></pre>

<p>参阅: <a href="https://knackforge.com/blog/karalmax/how-enable-gzip-compression-apache">HOW TO ENABLE GZIP COMPRESSION IN APACHE</a></p>

<h3 id="其他服务器优化文章">其他服务器优化文章</h3>

<ul>
<li><a href="https://cloud.tencent.com/developer/article/1004879">Apache 性能配置优化</a></li>
<li><a href="https://www.kancloud.cn/curder/apache/91275">apache服务器优化(重要)</a></li>
</ul>

<h2 id="其他">其他</h2>

<p>晚上突然发现博客不能正常访问了, 提示<code>Error Establishing a Database Connection</code>, 我擦, 怎么回事? 记得下班的时候还是好的?</p>

<p>然后想到我的MariaDB的账户是<code>root</code>, 密码是<code>123654</code>. 还开放了<code>phpmyadmin</code>的外网访问权限, 虽然对IP做了域名转向貌似已经无法web管理数据库了, 难道是安全问题?</p>

<p>于是SSH登陆进去, 试着连接数据库操作, 出现以下情况(一脸懵逼)</p>

<p><img src="/images/2018-03-16-1.png" alt="error" /></p>

<p>然后试着重置一下密码, 也不知道是不是跟这个有关系, 改完<code>mysql</code>密码和<code>wp-config.php</code>配置后, 博客可以正常访问了.</p>

<p>重置<code>MariaDB</code>的<code>root</code>密码参阅以下文章:</p>

<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-reset-your-mysql-or-mariadb-root-password">How To Reset Your MySQL or MariaDB Root Password</a></li>
<li><a href="https://linode.com/docs/databases/mariadb/how-to-install-mariadb-on-centos-7/">How to Install MariaDB on CentOS 7</a></li>
</ul>

<p>一不小心又折腾到了晚上十二点, 一直被一直吸满血的蚊子骚扰, 打死它就睡觉.</p>

</div>


    </main>

    
  </body>
</html>
