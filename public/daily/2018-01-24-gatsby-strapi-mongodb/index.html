<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>安装Gatsby和Strapi过程中的各种问题 :: Whidy Daily — Here is Whidy&#39;s github note, you will find somethings here.</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="2018年1月24日 阴 一般
 安装Gatsby和Strapi VPS上安装Gatsby和Strapi中遇到的各种问题解决方案和相关记录  参考Building a static blog using Gatsby and Strapi
 安装Gatsby  事情总是不是那么顺利.
 根据Gatsby文档Get started, 执行到如下命令时:
# gatsby new gatsby-site  报错, 需要git. 然而我的服务器没装, 那就装一个吧. 参考Download for Linux and Unix执行:
# yum install git  再次执行后依旧报错(当前git版本1.7.1)
error Command failed: git clone git://github.com/gatsbyjs/gatsby-starter-default.git gatsby-site --single-branch  推测是版本问题. 只好手动安装了. 于是又找到这个安装 Git
# yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel # wget https://www.kernel.org/pub/software/scm/git/git-2.16.1.tar.gz # tar -zxf git-2."/>
<meta name="keywords" content="whidy daily blog"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/daily/2018-01-24-gatsby-strapi-mongodb/" />


<link rel="stylesheet" href="/assets/style.css">



<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="安装Gatsby和Strapi过程中的各种问题 :: Whidy Daily — Here is Whidy&#39;s github note, you will find somethings here." />
<meta name="twitter:description" content="2018年1月24日 阴 一般
 安装Gatsby和Strapi VPS上安装Gatsby和Strapi中遇到的各种问题解决方案和相关记录  参考Building a static blog using Gatsby and Strapi
 安装Gatsby  事情总是不是那么顺利.
 根据Gatsby文档Get started, 执行到如下命令时:
# gatsby new gatsby-site  报错, 需要git. 然而我的服务器没装, 那就装一个吧. 参考Download for Linux and Unix执行:
# yum install git  再次执行后依旧报错(当前git版本1.7.1)
error Command failed: git clone git://github.com/gatsbyjs/gatsby-starter-default.git gatsby-site --single-branch  推测是版本问题. 只好手动安装了. 于是又找到这个安装 Git
# yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel # wget https://www.kernel.org/pub/software/scm/git/git-2.16.1.tar.gz # tar -zxf git-2." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="whidy" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="安装Gatsby和Strapi过程中的各种问题 :: Whidy Daily — Here is Whidy&#39;s github note, you will find somethings here.">
<meta property="og:description" content="2018年1月24日 阴 一般
 安装Gatsby和Strapi VPS上安装Gatsby和Strapi中遇到的各种问题解决方案和相关记录  参考Building a static blog using Gatsby and Strapi
 安装Gatsby  事情总是不是那么顺利.
 根据Gatsby文档Get started, 执行到如下命令时:
# gatsby new gatsby-site  报错, 需要git. 然而我的服务器没装, 那就装一个吧. 参考Download for Linux and Unix执行:
# yum install git  再次执行后依旧报错(当前git版本1.7.1)
error Command failed: git clone git://github.com/gatsbyjs/gatsby-starter-default.git gatsby-site --single-branch  推测是版本问题. 只好手动安装了. 于是又找到这个安装 Git
# yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel # wget https://www.kernel.org/pub/software/scm/git/git-2.16.1.tar.gz # tar -zxf git-2." />
<meta property="og:url" content="/daily/2018-01-24-gatsby-strapi-mongodb/" />
<meta property="og:site_name" content="安装Gatsby和Strapi过程中的各种问题" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2018-01-24 00:00:00 &#43;0000 UTC" />











</head>
<body class="">


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Daily Note
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/daily">Daily</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/daily">Daily</a></li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
  <div class="post">
    <h1 class="post-title"><a href="/daily/2018-01-24-gatsby-strapi-mongodb/">安装Gatsby和Strapi过程中的各种问题</a></h1>
    <div class="post-meta">
      <span class="post-date">
        2018-01-24
      </span>
      <span class="post-author">:: whidy</span>
    </div>

    

    

    <div class="post-content">
      

<blockquote>
<p>2018年1月24日 阴 一般</p>
</blockquote>

<h1 id="安装gatsby和strapi">安装Gatsby和Strapi</h1>

<h2 id="vps上安装gatsby和strapi中遇到的各种问题解决方案和相关记录">VPS上安装Gatsby和Strapi中遇到的各种问题解决方案和相关记录</h2>

<blockquote>
<p>参考<a href="https://hackernoon.com/building-a-static-blog-using-gatsby-and-strapi-8b5acfc82ad8">Building a static blog using Gatsby and Strapi</a></p>
</blockquote>

<h3 id="安装gatsby">安装Gatsby</h3>

<blockquote>
<p>事情总是不是那么顺利.</p>
</blockquote>

<p>根据Gatsby文档<a href="https://www.gatsbyjs.org/docs/">Get started</a>, 执行到如下命令时:</p>

<pre><code class="language-bash"># gatsby new gatsby-site
</code></pre>

<p>报错, 需要<code>git</code>. 然而我的服务器没装, 那就装一个吧. 参考<a href="https://git-scm.com/download/linux">Download for Linux and Unix</a>执行:</p>

<pre><code class="language-bash"># yum install git
</code></pre>

<p>再次执行后依旧报错(当前git版本<code>1.7.1</code>)</p>

<pre><code class="language-bash">error Command failed: git clone git://github.com/gatsbyjs/gatsby-starter-default.git gatsby-site --single-branch
</code></pre>

<p>推测是版本问题. 只好手动安装了. 于是又找到这个<a href="https://git-scm.com/book/zh/v1/%E8%B5%B7%E6%AD%A5-%E5%AE%89%E8%A3%85-Git">安装 Git</a></p>

<pre><code class="language-bash"># yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel
# wget https://www.kernel.org/pub/software/scm/git/git-2.16.1.tar.gz
# tar -zxf git-2.16.1.tar.gz
# cd git-2.16.1
# make prefix=/usr/local all
# sudo make prefix=/usr/local install
</code></pre>

<p>漫长的<code>make prefix=/usr/local all</code>之后, 提示:</p>

<pre><code class="language-bash">    SUBDIR perl
/usr/bin/perl Makefile.PL PREFIX=\'/usr/local\' INSTALL_BASE=\'\' --localedir=\'/usr/local/share/locale\'
Can\'t locate ExtUtils/MakeMaker.pm in @INC (@INC contains: /usr/local/lib64/perl5 /usr/local/share/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5 .) at Makefile.PL line 3.
BEGIN failed--compilation aborted at Makefile.PL line 3.
make[1]: *** [perl.mak] Error 2
make: *** [perl/perl.mak] Error 2
</code></pre>

<p>蛋疼, 等了半天, 又要解决这个问题, 好在看起来比较容易处理, 参考<a href="https://github.com/qsnake/qsnake/issues/12">git fails to build in Fedora 14</a>, 然后继续执行最后两条<code>make</code>命令, 虽然最后出来很多看起来很奇怪的内容, 不过似乎是成功了. 执行:</p>

<pre><code class="language-bash"># git --version
git version 2.16.1
</code></pre>

<p>接下来我们再一次执行<code>gatsby new gatsby-site</code>, 我擦还提示刚才的<code>...single-branch</code>的error, 这就坑爹了- -. 经过简短的排查. 原来似乎他还是跑的旧版git, 需要删掉之前yum自动安装的<code>git 1.7.1</code>, 我单纯的以为直接自动升级了. 于是:</p>

<pre><code class="language-bash"># yum remove git
</code></pre>

<p>按照提示删除成功后, 再次检测git还是ok的, 这次我第三次执行<code>gatsby new gatsby-site</code>, 终于成功了! 我这小白也不知道linux软件管理是咋整的. 反正能继续执行卡了我半天的gatsby就好了吧&hellip;</p>

<p>剩下的依照接下来的文档操作就好了, 很快就看到了Gatsby主页了~ &ldquo;Hi people&rdquo;!</p>

<blockquote>
<p>此时几乎耗费了一上午的时间了, 嘘&hellip; 期待能通过尝试学习到react, graphQL等相关的内容</p>
</blockquote>

<h3 id="安装strapi">安装Strapi</h3>

<blockquote>
<p>Requirements: please make sure <strong>Node 8</strong> (or higher) and <strong>MongoDB</strong> are installed and running on your machine.</p>
</blockquote>

<p>此时, 暗喜前阵子已经琢磨出来了并装好了<code>Node 8</code>, 不过装MongoDB就没有了. 果断找到文档<a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/">Install MongoDB Community Edition on Red Hat Enterprise or CentOS Linux</a>, 这个redhat和centOS应该是通用的吧- -! 看到<a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/#configure-the-package-management-system-yum">Configure the package management system (yum).</a>, 发现原来还有这种操作, 创建repo文件, 来安装对应版本的软件. 闲话少说, 按步骤很快就装好了. 此时需要启动mongod再继续安装Strapi, 如下命令:</p>

<pre><code class="language-bash"># service mongod start
</code></pre>

<p>到了这个步骤的时候</p>

<pre><code class="language-bash"># strapi start
</code></pre>

<p>卡住了, 频繁报错如下</p>

<pre><code class="language-bash">[root@whidy api]# strapi start
DEBUG (24910 on whidy): Server wasn't able to start properly.
ERROR (24910 on whidy): (hook:mongoose) takes too long to load
</code></pre>

<p>大概是网络原因, 我联通网络出问题, 换了电信几番尝试就好了, 创建了admin账户后, 进入后台继续按步骤操作.</p>

<blockquote>
<p>操作过程中频繁出现刚才的问题, 我觉得不是网络问题那么简单, 我打算从数据库方面着手完善一下试试</p>
</blockquote>

<pre><code class="language-bash"># mango
&gt; use admin
&gt; db.createUser(
    {
      user: &quot;username&quot;,
      pwd: &quot;userpassword&quot;,
      roles: [ { role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; } ]
    }
  )
# mongo --port 27017 -u &quot;username&quot; -p &quot;userpassword&quot; --authenticationDatabase &quot;admin&quot;
</code></pre>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">查看其他</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="/daily/2018-01-25-gatsby-strapi-mongodb/">
                <span class="button__icon">←</span>
                <span class="button__text">安装Gatsby和Strapi过程中的各种问题</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="/daily/2018-01-23-javascript-es6-babel/">
                <span class="button__text">null和undefined复习/ES6作用域和babel的探索</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

  </div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2019 Powered by <a href="http://gohugo.io">Hugo</a></span>
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
